<!DOCTYPE html>
<html>
  <head>
    <title>Contador</title>
  </head>
  <body>
    <h1 id="contador">0</h1>
    <button onclick="aumentar()">Aumentar</button>
    <div id="events-container"></div>
    <script>
      let url = 'https://general-2e89b-default-rtdb.firebaseio.com/index.json'; 
      let contador = 0;
      fetch(url)
        .then(response => response.json())
        .then(data => {
          contador = data.contador;
          document.getElementById('contador').innerHTML = contador;
        })
        .catch(error => console.error(error));
        
      function aumentar() {
        contador++;
        document.getElementById('contador').innerHTML = contador;
        fetch(url, {
          method: 'PUT',
          body: JSON.stringify({ contador: contador })
        })
          .then(response => console.log(response))
          .catch(error => console.error(error));
      }

      let eventsArr = [];

      function getEvents() {
        fetch('https://general-2e89b-default-rtdb.firebaseio.com/eventsArr.json')
          .then(response => response.json())
          .then(data => {
            for (const key in data) {
              if (Object.hasOwnProperty.call(data, key)) {
                const eventsData = data[key];
                eventsArr.push(...eventsData);
              }
            }

            const eventsContainer = document.getElementById('events-container');
            eventsContainer.innerHTML = eventsArr.map(event => {
              return `<div><h3>${event.day}/${event.month}/${event.year}</h3><ul>${event.events.map(e => `<li>${e.title} - ${e.time}</li>`).join('')}</ul></div>`;
            }).join('');
          })
          .catch(error => console.error(error));
      }

      getEvents();

    </script>
  </body>
</html>
